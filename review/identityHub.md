## 个人数据存储的身份中心

当今世界充满集中化社交媒体、数据泄露、Cambridge Analytica公司数据丑闻类似的问题，不言而喻，这需要个人隐私需以一种新的方式更进一步，让人们能够收回对其身份各方面的控制权，跨越物理世界和数字世界。

作为数据经济的盘观者不再站得住脚，我们每个人都需要成为自己数据的主人，我们需要一种方法来做到这一点，即否定服务提供商会尊重我们的意愿。我们需要安全加密的数据存储和交换机制，让我们每个人都能够控制自己的数据。

目前，我们得大多数数字身份和个人数据都是由一些中心化服务提供商控制。这些服务商（通常是公司），控制着我们的数据，包括但不限于拒绝和撤销对它的访问。

在微软，我们相信世界需要新的模型，我们队这个模型的愿景很简单：

``每个用户都需要拥有和控制自己的数字身份，他们可以安全地，私密地存储他们的所有个人数据。这种自有数字身份必须直观且便于管理，并提供对身份数据访问和使用方式的完全控制。``

我们认为，植根于分布式账本技术（区块链和其他相关技术）的去中心化身份是实现这一愿景的最佳选择。去中心化身份使用户可以完全控制他们的个人数据以及访问方式。它们消除了中心化实体（包括Microsoft）在用户与其应用，服务和关系之间访问的能力。

要了解有关我们愿景的更多信息，您可以访问[去中心化身份](https://azure.microsoft.com/en-us/overview/decentralized-identity/)。今天，我们宣布了将这一愿景变为现实的下一步。

通过这篇博文，我们宣布了为去中心化身份基金会（DIF）身份中心的开源参考实施贡献代码的意图。

### 什么是身份中心？

``注意``：如果您不熟悉DIF提出的去中心化身份的一般体系结构，您应该首先阅读本白皮书中关于系统和方法的概述。

在去中心化身份系统中，标识符和公钥可以锚定到各种分布式帐本技术（DLT），例如比特币，以太坊以及符合社区通过[去中心化身份](https://identity.foundation/)基础定义的标准的各种其他技术和W3C证书社区小组。

这些分布式帐本技术非常适合为去中心化标识符提供不可变的基础，但不应用于存储个人身份数据。这与设计隐私和现有和新兴数据法规（如GDPR）的目标不一致。

相反，我们需要一种不同的解决方案来安全存储个人数据和信息。

身份中心就是这样的解决方案，身份中心是去中心化的链下个人数据存储，可以控制用户手中的个人数据。它们允许用户以防止任何人未经其明确许可使用其数据的方式，存储其敏感数据（身份信息，官方文档，应用程序数据等）。

用户可以使用他们的身份中心与其他人，应用程序和企业安全地共享他们的数据，从而提供对必要的最少数据的访问，同时保留其使用记录。

应用程序开发人员可以通过将敏感数据存储在用户的Hub中来降低数据管理和合规性的复杂性。这种方法降低了应用程序开发人员隐私侵犯和数据泄露的风险，因为应用程序不再需要存储数据。

Identity Hub规范正在DIF中开发，同时还有一个开源参考实现。这有助于可能希望在自己的设备或基础架构上运行身份中心（Identity Hub）的开发人员和提供商更好地了解API和体系结构。

可以在DIF的[GitHub仓库](https://github.com/decentralized-identity)中找到Identity Hub软件包的源代码。完成DIF Identity Hub参考实施的开发后，用户将能够在任何他们想要的地方运行自己的Hub，从而完全控制其数据的存储和管理。

Hub的一个关键属性是跨设备和跨云的同步和复制能力，这意味着用户可以使用他们选择的任何提供商在任何地方运行其身份中心，例如在Microsoft基础架构或其他任何地方。此类身份中心可以跨实例同步数据，以确保没有单点故障。符合DIF标准的提供商都没有办法查看谁在分享哪些数据以及与谁共享。

`本博客的其余部分介绍了Identity Hub的主要功能，以及它们如何通过数据实现更强的用户控制和隐私 `

### 接口

DIF社区正在考虑的提议的Identity Hubs规范草案描述了三个关键接口：

| 接口            | 描述                                                         |
| --------------- | ------------------------------------------------------------ |
| Collection集合  | 集合接口是存储个人数据的主要接口， 与用户相关的任何语义数据应使用此接口存储。 |
| Profile配置     | 描述有关DID的基本公共信息的特殊对象，可以使用Profile接口访问。 这可能包括DID的类型（用户，业务，设备等），一般描述及联系信息，以及其他典型的配置文件详细信息。 |
| Permissions权限 | 权限接口注册、管理和实施混合对象功能，这些功能用于在Hub实例中创建访问和加密边界。 |

当对Identity Hub进行编程时，请选择最适合您场景的接口。 在大多数情况下，通常是Collections接口。 DIF Identity Hub规范中还有其他几个接口仍处于开发阶段。当这部分获得更多共识且我们资源允许的情况下，我们计划全部实施这些接口。

#### 语义数据模型


与传统数据存储相反，Identity Hub不需要预定义模式或数据库模型。 相反，Hubs遵循开放的动态语义数据模型，该模型允许用户及其授权的个人、应用程序和服务存储并与通过语义JSON模式表示的任何数据进行交互。

举个例子，存储在Hub中的音乐播放列表可以表示为：

```json
{
  "@context": "http://schema.org",
  "@type": "MusicPlaylist",
  "name": "Classic Rock Playlist",
  "numTracks": "5",
  "track": [
    {
      "byArtist": "Lynard Skynard",
      "duration": "PT4M45S",
      "inAlbum": "Second Helping",
      "name": "Sweet Home Alabama",
    }
  ]
}
```

在示例中，@ context和@type元数据字段告知Hub该对象是音乐播放列表。使用Collections接口写入Hub时，它会将播放列表与其他相同类型的音乐播放列表一起存储。用户可以允许不同的应用程序在用户的Hub中读取和写入音乐播放列表，其中它们都可以从一组共同的音乐播放列表条目中工作。应用程序开发人员可以利用现有的行业特定模式，例如schema.org，gs1.org和hl7.org中描述的模式。如果需要，任何用户或开发人员都可以发布应用程序和服务可用于协作存储和访问数据的自定义架构。

使用现有的、广泛接受的模式来存储应用程序的数据是非必需的，但强烈建议使用。为此，开发人员需要确保在他们希望与之交互的对象上设置正确的上下文/类型字段和数据属性，Hub将负责其余的工作。这种开放的语义数据模型确保Hub可以充当通用个人数据存储，可以灵活地适应各种数据和用例 - 包括个人信息，应用数据，医疗记录等。

目前，我们的Identity Hub版本仅支持简单的JSON数据，不支持图像，视频，字节流，原始文件和其他内容类型。 Hub服务API教程描述了如何在云Identity Hub服务之间发送JSON数据。

#### 提交Commits

Identity Hub中的每个单独的数据称为“对象”。身份中心中的每个对象都由一系列“提交”组成。

Identity Hub上下文中的提交就像是对repo的git提交，因为它表示对对象的更改。要将数据写入Identity Hub，我们需要构建新的提交并将其发送到Hub。

要从Identity Hub读取数据，必须从Hub获取所有相关提交，并通过按顺序应用其所有提交来构造对象的当前值。使用提交来表示Identity Hub中数据的方式提供了一些明显的优势：

- 使Hub能够通过无冲突的复制协议进行通信，从而使多个集线器实例能够在它们之间同步数据。

- 它为对象创建可更改的历史记录，尤其是在每个提交都由DID签名时。

- 它简化了需要离线数据修改的应用程序和服务用例的实现，因为多机离线可能会出现多写入冲突。

  提交的确切详细信息（包括当前如何读取和写入Identity Hub）包含在我们的Hub服务API参考和Hub教程中。

  显然，典型的应用程序开发人员不需要知道提交处理的复杂性：缓存和水印增量应该提供编程接口的优化和简化，因此简单的写入或读取通常就足够了。但是我们当前版本的Identity Hubs不包含此类优化，不过对想要评估预览版本的开发人员具有指导性和完全可用性。

#### 权限Permissions
`注意`：在用户代理钱包创建图形界面以支持其创建和管理之前，终端用户不易与Identity Hub权限进行交互。目前，开发人员可以利用示例代码来理解关键权限概念。
Identity Hub的权限系统可确保用户保持对其数据访问的完整、细粒度控制，只要用户可以单独访问其DID的私钥，其他任何人都无法访问存储在Identity Hub中的数据。
使用PermissionGrant对象通过Permissions接口访问Identity Hub中的数据时受限的。根据规则，拥有Identity Hub的DID始终具有读取，修改，写入和删除Identity Hub中的任何和所有数据的完全访问权限。Identity Hub的所有者的DID可以在其Hub中创建PermissionGrant对象，以授予其他DID访问数据的权限。由于PermissionGrants是使用提交进行修改的，因此用户会保留可审核的日志，告知谁可以在什么时间访问哪些数据。例如：

```json
{
  "@context": "https://identity.foundation",
  "@type": "PermissionGrant",
  "owner": "did:example:abc123",
  "grantee": "did:example:xyz456", // who is being granted access
  "context": "https://schema.org",
  "type": "MusicPlaylist", // what objects are being accessed
  "allow": "-R--", // allows create, read, update, and delete
}
```

PermissionGrants的建模方式与Hub中的任何其他对象一样，可以通过Permissions接口访问。在Identity Hub中创建此授权时，它会为DID `did:example:xyz456`读取用户Identity Hub中所有音乐播放列表的权限。
权限授予具有额外的控制，以更细粒度的级别限制数据访问。有关Hub权限系统的完整详细信息，请参阅我们的Hub服务API参考。
[您可以在此处查看权限规范的完整参考](https://github.com/decentralized-identity/identity-hub/blob/master/docs/permissions.md)。

#### 加密Encryption

`注意`：与Identity Hub实例交互的能力仅适用于开发人员探索，规范和实现的加密部分尚未实现。请勿在此时存储任何个人和/或敏感信息。

Identity Hub的最后一个方面是确保数据能够被保护的加密子系统，Hub的加密系统的目标是在数据传递到Hub实例之前加密边缘的所有数据。这样，Hub提供着永远不会以明文形式看到对象的内容。

目前，Hub的数据加密支持仍在开发中。与此同时，我们的Identity Hub云服务以其他两种方式保护数据：

- 通过线路发送到hub的数据使用与目标hub关联的DID密钥进行加密，这可确保数据在传输过程中保密。
- 存储在Hub服务中的数据使用传统的数据库加密技术进行加密，这有助于确保数据安全无虞。

#### 复制Replication

`注意`：Identity Hub复制仍在DIF中进行规范，并且在撰写本文时我们正在积极地对该功能进行原型设计。

Identity Hub的另一个方面是单个DID可以有许多Hub实例。所有Hub实例都将数据复制到另一个实例，以便用户的个人数据存储分布在多个不同的物理数据存储中。

Identity Hub可以在云端，边缘设备或任何可以实现Identity Hub复制协议的基础架构上运行。这意味着用户不必依赖单个云提供商（如Microsoft）作为其个人数据的单一集中保管人。相反，用户可以在他们实际拥有的设备上维护其Identity Hub的复制实例。他们还可以设置多个云Hub提供商，以降低其数据不可用的风险。此外，我们还致力于为社区做出贡献，并通过其他连接器和存储为其提供实施选择，例如本地数据存储。

#### 隐私Privacy

注意：与Identity Hub实例交互的能力仅供开发人员探索 - 规范和实现的许多部分正在进行积极的开发。请勿在此时存储任何个人和/或敏感信息。

很明显，用户需要在他们不同的上下文之间保持严格的区分，为每个上下文采用成对的DID。同时，用户的Identity Hub需要易于发现，以便应用和服务可以定位数据存储并与之通信。 Identity Hub设计必须确保无法根据用于通信的Identity Hub元数据关联两个DID。

身份中心以三种方式维护隐私。首先，每个DID文档中都包含指向DID Identity Hub的指针，这使Hub可被发现。其次，Identity Hub提供商像Microsoft这样使用单个URL来接收请求（通过线路消除DID目标暴露），并在后台将请求路由到相应的Hub实例。第三，Hub请求中的所有数据和元数据都封装在使用Hub提供程序的DID密钥加密的JWE中。这使得窃听者无法推断出Hub请求所属的DID。用户可以根据需要创建尽可能多的DID，并确信他们的Hub不会泄露它们之间的任何关系。

### Microsoft的Identity Hub实例

在Microsoft，我们都参与了DIF Identity Hub项目的开源参考实现，并开发了我们自己的实例，针对大规模进行了优化。当Microsoft的实例完全运行时，它将提供安全的，地理冗余的Identity Hub服务，该服务由Azure的运营保证支持。 Identity Hub服务遵循我们的安全开发生命周期准则（SDL），并根据我们的安全部署实践进行部署。

#### 早期版本的Identity Hub版本的功能摘要

``目前可用``：

1、Microsoft云托管了Identity Hub实例（早期开发版）
2、使用语义数据模型基于提交的JSON对象存储和检索。
3、在线上请求身份验证和加密以确保隐私。
4、简化权限模型，以授予第三方对数据的访问权限。
5、NodeJS SDK，用于读写Identity Hub。
``接下来``：

1、在本地边缘设备上运行的集线器实现。
2、边缘数据加密，以确保集线器无法访问原始数据。
3、用于启用多个Hub实例的复制协议。
4、添加新的提交策略，例如CRDT和最后写入获胜。
5、用于获取Hub数据的丰富查询。
… 以及更多！